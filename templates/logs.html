<!--
  ~ Copyright (c) 2025. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  ~ Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
  ~ Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
  ~ Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
  ~ Vestibulum commodo. Ut rhoncus gravida arcu.
  ~ author:lwl
  ~ Collaborator:cr and lx and tyf
  -->

<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æ‰«ææ—¥å¿—</title>
    <link rel="stylesheet" type="text/css" href="{{url_for('static',filename='./css/style.css')}}">
</head>
<body>
    <div class="header">
        <img src="{{url_for('static',filename='./img/SUNc.png')}}">
        <h1>æ‰«ææ—¥å¿—</h1>
        <a href="/" class="log-link">è¿”å›é¦–é¡µ</a>
    </div>

    <div class="logs-container">
        <div class="filters">
            <button class="filter-btn active" data-filter="all">å…¨éƒ¨</button>
            <button class="filter-btn" data-filter="xss">XSSæ‰«æ</button>
            <button class="filter-btn" data-filter="sql">SQLæ³¨å…¥æ‰«æ</button>
        </div>

        <table id="logs-table">
            <thead>
                <tr>
                    <th>æ—¶é—´</th>
                    <th>ç±»å‹</th>
                    <th>URL</th>
                    <th>ç»“æœæ‘˜è¦</th>
                    <th>çŠ¶æ€</th>
                </tr>
            </thead>
            <tbody>
                {% for log in logs %}
                <tr class="log-row" data-type="{{ log.scan_type|default('xss') }}">
                    <td>{{ log.scan_date }}</td>
                    <td class="log-type">
                        {% if log.scan_type == 'sql' %}
                            SQLæ³¨å…¥
                        {% else %}
                            XSS
                        {% endif %}
                    </td>
                    <td class="log-url">{{ log.url }}</td>
                    <td class="log-result">
                        {{ log.scan_result.split('\n')[0] }}
                    </td>
                    <td>
                        {% if "æœªå‘ç°" in log.scan_result %}
                            <span class="status safe">å®‰å…¨</span>
                        {% else %}
                            <span class="status detected">å­˜åœ¨æ¼æ´</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <script>
        document.querySelectorAll('.filter-btn').forEach(button => {
            button.addEventListener('click', () => {
                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                button.classList.add('active');

                // è¿‡æ»¤æ—¥å¿—
                const filter = button.dataset.filter;
                const rows = document.querySelectorAll('.log-row');

                rows.forEach(row => {
                    if (filter === 'all') {
                        row.style.display = '';
                    } else {
                        if (filter === 'all' || row.querySelector('.log-type').textContent.trim() === (filter === 'xss' ? 'XSS' : 'SQLæ³¨å…¥')) { //ğŸ‘‡
                            row.style.display = '';
                        } else {
                            row.style.display = 'none';
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>

<!--if (row.dataset.type === filter)  -->